!function($){"use strict";var initialBodyOverflowY="",initialHtmlOverflowY="",selectionInProgress=!1,lastSelectedElement=!1,currentStep=!1,currentTour=!1;$.fn.zWidth=function(){var t=$(this).width();return isNaN(t)&&(t=0),t},$.fn.zHeight=function(){var t=$(this).height();return isNaN(t)&&(t=0),t},wutb_toursData=wutb_toursData[0];for(var i=0;i<wutb_toursData.tours.length;i++)wutb_toursData.tours[i].tourData=JSON.parse(wutb_toursData.tours[i].tourData);function onResize(){updateOverlay(),updateArrow(),updateElementText(),updateTooltip(),updateOverlayElement()}function getTourByID(t){for(var e=!1,n=0;n<wutb_toursData.tours.length;n++)wutb_toursData.tours[n].id==t&&(e=wutb_toursData.tours[n]);return e}function getStepByID(t,e){for(var n=!1,o=0;o<e.tourData.steps.length;o++)e.tourData.steps[o].id==t&&(n=e.tourData.steps[o]);return n}function getStartStepByTour(t){for(var e=!1,n=0;n<t.tourData.steps.length;n++)t.tourData.steps[n].start&&(e=t.tourData.steps[n]);return e}function initTours(){if(0<wutb_toursData.previewStep)$("#wpadminbar").hide();else if(0<wutb_toursData.previewTour)(e=getTourByID(wutb_toursData.previewTour))&&startTour(currentTour=e);else if(null!==sessionStorage.getItem("wutb_currentStep")){var t=JSON.parse(sessionStorage.getItem("wutb_currentStep"));(currentTour=getTourByID(t.tourID))&&(currentTour.clickedButtons=new Array,showStep(t))}else if(!isIframe())for(var e,n=0;n<wutb_toursData.tours.length;n++)if((e=wutb_toursData.tours[n]).tourData.settings.activated)if("elementClick"==e.tourData.settings.startMethod)""!=e.tourData.settings.tourDomElement&&0<$(e.tourData.settings.tourDomElement).length&&($(e.tourData.settings.tourDomElement).attr("data-tourid",e.id),$(e.tourData.settings.tourDomElement).on("click",function(t){var e=getTourByID($(this).attr("data-tourid")),n=!0;if((e.tourData.settings.runOnce&&null!==localStorage.getItem("wutb_viewedTour_"+e.id)&&(n=!1),("mobiles"==e.tourData.settings.devices&&480<$(window).zWidth()||"computers"==e.tourData.settings.devices&&$(window).zWidth()<=480)&&(n=!1),n)&&(t.preventDefault(),!currentTour&&(e=getTourByID($(this).attr("data-tourid")))))return startTour(e),!1}));else if(isCurrentUrl(e.tourData.settings.startURL)){var o=!0;e.tourData.settings.runOnce&&null!==localStorage.getItem("wutb_viewedTour_"+e.id)&&(o=!1),("mobiles"==e.tourData.settings.devices&&480<$(window).zWidth()||"computers"==e.tourData.settings.devices&&$(window).zWidth()<=480)&&(o=!1);var r,s=getStartStepByTour(e);if(s?(r=wutb_toursData.adminUrl.replace(wutb_toursData.siteUrl,""),(""==s.settings.url&&1==wutb_toursData.isAdmin||1==wutb_toursData.isAdmin&&-1==s.settings.url.indexOf(r)||0==wutb_toursData.isAdmin&&-1<s.settings.url.indexOf(r)||-1<document.location.href.indexOf("wutb_menu"))&&(o=!1)):o=!1,o){startTour(e);break}}}function isCurrentUrl(t){var e=!1,n=document.location.href;return-1<n.indexOf("&stepPreview=")&&(n=n.substr(0,wutb_toursData.siteUrl.indexOf("&stepPreview="))),-1<n.indexOf("?stepPreview=")&&(n=n.substr(0,wutb_toursData.siteUrl.indexOf("?stepPreview="))),""==t&&0==wutb_toursData.isAdmin||0==n.indexOf(wutb_toursData.adminUrl)&&0==wutb_toursData.isAdmin?e=!0:(-1<wutb_toursData.siteUrl.indexOf("?")&&(wutb_toursData.siteUrl=wutb_toursData.siteUrl.substr(0,wutb_toursData.siteUrl.indexOf("?"))),t=wutb_toursData.siteUrl+t,0<n.indexOf("#")&&-1==n.indexOf("#post-")&&(n=document.location.href.substr(0,document.location.href.lastIndexOf("#"))),0<n.indexOf("/index.php")&&(n=n.substr(0,n.lastIndexOf("/"))),0<t.indexOf("index.php")&&(t=t.substr(0,t.lastIndexOf("/"))),-1<t.indexOf("[USERURL]")&&(t=wutb_toursData.profileUrl),""!=wutb_toursData.username&&(t=t.replace("[USERNAME]",wutb_toursData.username)),""!=wutb_toursData.post_id&&(t=t.replace("[POSTID]",wutb_toursData.post_id)),""!=wutb_toursData.group&&(t=t.replace("[GROUP]",wutb_toursData.group)),((t=(t=(t=(t=(t=(t=(t=t.replace("[USERNAME]","")).replace("[POSTID]","")).replace("[GROUP]","")).replace("[USERURL]","")).replace(/\/\//g,"/")).replace(/http:\//g,"http://")).replace(/https:\//g,"https://"))==n||t+"/"==n||t==n+"/"||-1<t.indexOf("[ANY]")&&0==n.indexOf(t.replace("[ANY]","")))&&(e=!0)),e}function executePreviewAction(){var t=$("body").data("wutb_lastPreviewAction"),e=$("body").data("wutb_lastPreviewValue");"updateStepPreview"==t?showStepContent(e):"startElementSelection"==t?startElementSelection():"continueElementSelection"==t?continueElementSelection():"confirmElementSelection"==t?confirmElementSelection():"startPageSelection"==t?startPageSelection():"updateOverlay"==t&&updateOverlay()}function showStep(t){var e;t&&(e=new Array,null!==sessionStorage.getItem("wutb_previousSteps")&&(e=sessionStorage.getItem("wutb_previousSteps").split(",")),-1==e.indexOf(currentStep.id)&&e.push(currentStep.id),sessionStorage.setItem("wutb_previousSteps",e.join(","))),sessionStorage.setItem("wutb_currentStep",JSON.stringify(t)),void 0!==t.mode&&"preview"==t.mode?showStepContent(t):(0<$("#wutb_stepContainer").length&&$("#wutb_stepContainer > *:not(#wutb_overlay)").fadeOut(1e3),t.settings.useOverlay&&0<$("#wutb_stepContainer").length?($("#wutb_overlay").attr("id","wutb_overlay2"),isCurrentUrl(t.settings.url)?setTimeout(function(){showStepContent(t)},1e3*t.settings.startDelay+1e3):("redirection"==t.settings.type&&$("html,body").animate({scrollTop:0},500),showStepContent(t))):setTimeout(function(){isCurrentUrl(t.settings.url)&&"redirection"==t.settings.type&&$("html,body").animate({scrollTop:0},500),showStepContent(t)},1e3*t.settings.startDelay))}function drawOverlay(){1==$("#wutb_overlay2").length&&($("#wutb_overlay2").animate({opacity:0},1e3),setTimeout(function(){$("#wutb_overlay2").remove()},1200)),0==$("#wutb_overlay").length&&currentStep?("showElement"!=currentStep.settings.type||0<$(currentStep.settings.domElement).length)&&($("#wutb_stepContainer").append('<canvas id="wutb_overlay"></canvas>'),$("#wutb_overlay").attr({width:jQuery(window).zWidth(),height:jQuery("body").zHeight()}).css({width:jQuery(window).zWidth(),height:jQuery("body").zHeight()}),$("#wutb_overlay").css({opacity:0}).animate({opacity:1},1e3)):$("#wutb_overlay").css({opacity:0}).animate({opacity:1},1e3)}function isIframe(){try{return window.self!==window.top}catch(t){return 1}}function nl2br(t,e){return null==t?"":(t+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1"+(e||void 0===e?"<br />":"<br>")+"$2")}function showStepContent(step){var stepSettings=step.settings;currentStep=step;var chkStepContainer=!1;if(0<$("#wutb_stepContainer").length&&(chkStepContainer=!0,$("#wutb_stepContainer *:not(#wutb_overlay2)").remove()),stepSettings.url=stepSettings.url.replace("[USERNAME]",wutb_toursData.username),-1<stepSettings.url.indexOf("[USERURL]")&&(stepSettings.url=wutb_toursData.profileUrl),stepSettings.url=stepSettings.url.replace("[POSTID]",wutb_toursData.post_id),stepSettings.url=stepSettings.url.replace("[GROUP]",wutb_toursData.group),isCurrentUrl(stepSettings.url)){sessionStorage.removeItem("wutb_currentStep");var $stepPreview=$("#wutb_stepContainer");chkStepContainer||($stepPreview=$('<div id="wutb_stepContainer" data-tour="'+step.tourID+'" class="wutb_bootstraped"></div>'),$("body").append($stepPreview)),stepSettings.useOverlay&&(drawOverlay(),setTimeout(function(){updateOverlay()},500)),currentTour&&(stepSettings.dialog_font=currentTour.dialog_font,stepSettings.tooltip_font=currentTour.tooltip_font,stepSettings.tooltip_font=currentTour.tooltip_font,stepSettings.arrow_font=currentTour.arrow_font);var mustShow=!0,tooltip,navbar,pastSteps,potentialSteps;if(stepSettings.text=stepSettings.text.replace(/\n/g,"<br />"),"text"==stepSettings.type){var delay=0;(void 0===step.mode||"preview"!=step.mode||void 0!==step.settings.enableEntry&&step.settings.enableEntry)&&(delay=800),setTimeout(function(){var t,e="";""!=stepSettings.headerText&&(e='<div class="wutb_fullscreenTitle animated">'+stepSettings.headerText+"</div>"),$stepPreview.append('<div class="wutb_fullscreenTextContainer"><div class="wutb_fullscreenText ">'+e+'<div class="wutb_fullscreenTextContent animated">'+nl2br(stepSettings.text)+"</div></div></div>"),$stepPreview.find(".wutb_fullscreenText").css({fontSize:stepSettings.textSize+"px",color:stepSettings.textColor,fontFamily:stepSettings.texts_font}),$stepPreview.find(".wutb_fullscreenTitle").css({color:stepSettings.headerTextColor,fontSize:stepSettings.headerTextSize+"px",fontFamily:stepSettings.dialog_font}),$stepPreview.find(".wutb_fullscreenTitle").css("opacity",0),$stepPreview.find(".wutb_fullscreenTitle").animate({opacity:1},500),""==stepSettings.entryAnimation||void 0!==step.mode&&"preview"==step.mode||(t=0,""!=e&&($stepPreview.find(".wutb_fullscreenTitle").addClass(stepSettings.entryAnimation),$stepPreview.find(".wutb_fullscreenTextContent").css("opacity",0),t=1),setTimeout(function(){$stepPreview.find(".wutb_fullscreenTextContent").show(),$stepPreview.find(".wutb_fullscreenTextContent").animate({opacity:1},500),$stepPreview.find(".wutb_fullscreenTextContent").addClass(stepSettings.entryAnimation)},1e3*t))},delay)}else if("executeJS"==stepSettings.type)isIframe()||setTimeout(function(){try{eval(stepSettings.codeJS)}catch(exception){console.log(exception)}},1e3*stepSettings.startDelay);else if("redirection"==stepSettings.type)callNextStep();else if("dialog"==stepSettings.type){$stepPreview.append('<div class="wutb_dialogContainer" role="dialog"><div class="wutb_dialog animated"><div class="wutb_dialog-body">'+stepSettings.text+"</div></div>"),""!=stepSettings.headerText&&($stepPreview.find(".wutb_dialog").prepend('<div class="wutb_dialog-header">'+stepSettings.headerText+'<a href="javascript:" class="wutb_dialogClose"><span class="fas fa-times"></span></a></div>'),$stepPreview.find(".wutb_dialogClose").on("click",function(){var t;void 0!==currentStep.mode&&"preview"==currentStep.mode||(""!=currentStep.settings.entryAnimation?(t=currentStep.settings.entryAnimation.replace("In","Out"),$(this).closest(".wutb_dialog").removeClass(currentStep.settings.entryAnimation),$(this).closest(".wutb_dialog").addClass(t),setTimeout(callNextStep,1e3)):callNextStep())})),0<step.buttons.length&&$stepPreview.find(".wutb_dialog").append('<div class="wutb_dialog-footer"></div>'),$stepPreview.find(".wutb_dialog-header").css({backgroundColor:stepSettings.headerColor,color:stepSettings.headerTextColor,fontFamily:stepSettings.dialog_font}),$stepPreview.find(".wutb_dialog-body").css({backgroundColor:stepSettings.backgroundColor,fontSize:stepSettings.textSize+"px",fontFamily:stepSettings.dialog_font}),$stepPreview.find(".wutb_dialog-footer").css({backgroundColor:stepSettings.footerColor,color:stepSettings.footerTextColor,fontFamily:stepSettings.dialog_font}),""==stepSettings.entryAnimation||void 0!==step.mode&&"preview"==step.mode||$stepPreview.find(".wutb_dialog").addClass(stepSettings.entryAnimation);for(var i=0;i<step.buttons.length;i++){var icon="";""!=step.buttons[i].icon&&(icon='<span class="fas '+step.buttons[i].icon+'"></span>');var $btn=$('<a href="javascript:" class="wutb_btn" data-url="'+step.buttons[i].finalPage+'" data-action="'+step.buttons[i].action+'">'+icon+step.buttons[i].title+"</a>");$btn.css({backgroundColor:step.buttons[i].backgroundColor,color:step.buttons[i].textColor}),$btn.attr("data-id",step.buttons[i].id),void 0===step.mode&&"preview"!=step.mode&&$btn.on("click",buttonClicked),void 0!==currentTour.clickedButtons&&-1<currentTour.clickedButtons.indexOf($btn.attr("data-id"))&&(currentTour.clickedButtons=jQuery.grep(currentTour.clickedButtons,function(t){return t!=$btn.attr("data-id")})),$stepPreview.find(".wutb_dialog-footer").append($btn)}}else{"showElement"==stepSettings.type&&("arrow"==stepSettings.textStyle?0<$(currentStep.settings.domElement).length?($("#wutb_stepContainer").append('<div id="wutb_OverlayElement"></div>'),$stepPreview.append('<div id="wutb_arrow" class="animated" data-position="'+stepSettings.position+'" ><canvas id="wutb_arrowCanvas" ></canvas></div>'),$stepPreview.append('<div id="wutb_elementText"  data-position="'+stepSettings.position+'">'+stepSettings.text+"</div>"),$stepPreview.find("#wutb_elementText").css({fontSize:stepSettings.textSize+"px",color:stepSettings.textColor,fontFamily:stepSettings.arrow_font}),drawArrow(),updateArrow(),updateElementText(),updateOverlayElement(),""!=stepSettings.animation&&setTimeout(function(){$stepPreview.find("#wutb_arrow").addClass(stepSettings.animation),$stepPreview.find("#wutb_arrow").get(0).addEventListener("animationend",function(){setTimeout(function(){$stepPreview.find("#wutb_arrow").removeClass(stepSettings.animation),setTimeout(function(){$stepPreview.find("#wutb_arrow").addClass(stepSettings.animation)},2e3)},2e3)})},500),"click"==stepSettings.continueAction&&$("#wutb_OverlayElement").on("click",function(){$(stepSettings.domElement).is("a[href]")&&!$(stepSettings.domElement).is('a[href="#"]')&&!$(stepSettings.domElement).is('a[href="javascript:"]')||$(stepSettings.domElement).trigger("click"),callNextStep()}),isAnyParentFixed(jQuery(stepSettings.domElement))||"fixed"==jQuery(stepSettings.domElement).css("position")?$("html,body").animate({scrollTop:0},400):$("html,body").animate({scrollTop:$(stepSettings.domElement).offset().top-150},400)):(mustShow=!1,callNextStep()):"tooltip"==stepSettings.textStyle&&(0<$(currentStep.settings.domElement).length?($(stepSettings.domElement).attr("title",stepSettings.text),$("#wutb_stepContainer").append('<div id="wutb_OverlayElement"></div>'),"click"==stepSettings.continueAction&&$("#wutb_OverlayElement").on("click",callNextStep),tooltip=$('<div id="wutb_tooltip" class="animated"><div class="wutb_tooltipArrow"></div><div class="wutb_tooltipContent">'+stepSettings.text+"</div></div>"),$stepPreview.append(tooltip),tooltip.attr("data-position",stepSettings.position),tooltip.css({fontFamily:stepSettings.arrow_font}),""!=stepSettings.animation&&(tooltip.addClass(stepSettings.animation),updateTooltip(),tooltip.get(0).addEventListener("animationend",function(){setTimeout(function(){tooltip.removeClass(stepSettings.animation),setTimeout(function(){tooltip.addClass(stepSettings.animation)},4e3)},4e3)})),isAnyParentFixed(jQuery(stepSettings.domElement))||"fixed"==jQuery(stepSettings.domElement).css("position")?$("html,body").animate({scrollTop:0},400):$("html,body").animate({scrollTop:$(stepSettings.domElement).offset().top-150},400)):(mustShow=!1,callNextStep()),updateOverlayElement()),$(window).trigger("resize"),setTimeout(function(){$(window).trigger("resize")},500))}currentTour&&currentTour.stepTimer&&clearTimeout(currentTour.stepTimer),mustShow&&(!currentTour||"delay"!=step.settings.continueAction&&"showElement"==step.settings.type||"dialog"==step.settings.type&&0!=$(".wutb_dialog-footer a").length||(currentTour.stepTimer=setTimeout(callNextStep,1e3*step.settings.continueDelay)),currentTour&&currentTour.tourData.settings.showNavbar&&0==$("#wutb_navbar").length&&(navbar=$('<div id="wutb_navbar" class="" data-position="'+currentTour.tourData.settings.navbarPosition+'"></div>'),navbar.append('<a href="javascript:" data-action="previousStep" title="'+currentTour.tourData.settings.navbar_txtPreviousStep+'" ><span class="fas fa-step-backward"></span></a>'),navbar.append('<a href="javascript:" data-action="nextStep" title="'+currentTour.tourData.settings.navbar_txtNextStep+'" ><span class="fas fa-step-forward"></span></a>'),navbar.append('<a href="javascript:" data-action="stopTour" title="'+currentTour.tourData.settings.navbar_txtStopTour+'" ><span class="fas fa-stop"></span></a>'),$stepPreview.append(navbar),navbar.find("a").tooltip({tooltipClass:"wutb-tour-"+currentTour.id})),currentTour&&currentTour.tourData.settings.showNavbar&&(navbar.css({backgroundColor:currentTour.tourData.settings.navbarColor}),navbar.find("a").css({backgroundColor:currentTour.tourData.settings.navbarBtnsColor}),navbar.find('a[data-action="stopTour"]').on("click",stopTour),navbar.find('a[data-action="nextStep"]').on("click",callNextStep),navbar.find('a[data-action="previousStep"]').on("click",callPreviousStep),null!==sessionStorage.getItem("wutb_previousSteps")?(pastSteps=sessionStorage.getItem("wutb_previousSteps"),0==pastSteps.length&&navbar.find('a[data-action="previousStep"]').hide()):navbar.find('a[data-action="previousStep"]').hide(),potentialSteps=findPotentialsSteps(step.id,currentTour.id),0==potentialSteps.length&&navbar.find('a[data-action="nextStep"]').hide()))}else sessionStorage.setItem("wutb_currentStep",JSON.stringify(step)),document.location.href=wutb_toursData.siteUrl+stepSettings.url}function drawArrow(){var t,e;"showElement"==currentStep.settings.type&&0<$(currentStep.settings.domElement).length&&1==$("#wutb_arrow").length&&((t=$("#wutb_arrowCanvas").get(0).getContext("2d")).scale(2,2),(e=new Image).onload=function(){$("#wutb_arrowCanvas").attr("width",e.width),$("#wutb_arrowCanvas").attr("height",e.height),$("#wutb_arrowCanvas").css("width",Math.round(e.width/2)),$("#wutb_arrowCanvas").css("height",Math.round(e.height/2)),t.fillStyle=currentStep.settings.textColor,t.fillRect(0,0,e.width,e.height),t.fill(),t.globalCompositeOperation="destination-in",t.drawImage(e,0,0,e.width,e.height),updateArrow(),updateElementText()},e.src=wutb_toursData.assetsUrl+"img/arrowDown.png")}function startElementSelection(){selectionInProgress=!1,sessionStorage.setItem("wutb_selection",1),$("#wutb_stepContainer").fadeOut(350),setTimeout(function(){$("#wutb_stepContainer").remove()},400)}function continueElementSelection(){sessionStorage.setItem("wutb_selection",0),selectionInProgress=!0}function stopElementSelection(){selectionInProgress=!1,sessionStorage.setItem("wutb_selection",0)}function onSelectionElementClick(t){selectionInProgress=!1,sessionStorage.setItem("wutb_selection",0),$(".wutb_elementSelected").removeClass("wutb_elementSelected"),$(".wutb_selectionShadow").removeClass("wutb_selectionShadow"),t.addClass("wutb_elementSelected"),0==t.find("*").length&&"rgba(0, 0, 0, 0)"!=t.css("background-color")&&t.addClass("wutb_selectionShadow"),setTimeout(function(){t.removeClass("wutb_elementSelected")},3e3),window.top.jQuery("body").data("wutb_selectedElement",t),window.top.jQuery("body").trigger("wutb_elementSelected"),lastSelectedElement=t}function confirmElementSelection(){lastSelectedElement&&lastSelectedElement.addClass("wutb_targetElement")}function startPageSelection(){$("#wutb_stepContainer").fadeOut(350),setTimeout(function(){$("#wutb_stepContainer").remove()},400)}function updateOverlay2(t){var e;0<$("#wutb_overlay2").length&&($("#wutb_overlay2").attr({width:$(document).outerWidth(),height:$(document).outerHeight()}).css({width:$(document).outerWidth(),height:$(document).outerHeight()}),(e=$("#wutb_overlay2").get(0).getContext("2d")).globalAlpha=t.settings.overlayOpacity,"showElement"==t.settings.type&&0<$(t.settings.domElement).length&&(e.fillStyle="#FFFFFF",e.globalCompositeOperation="source-over",isAnyParentFixed($(t.settings.domElement))||"fixed"==$(t.settings.domElement).css("position")?e.fillRect($(t.settings.domElement).offset().left-5,$(t.settings.domElement).offset().top-5-$(t.settings.domElement).scrollTop(),$(t.settings.domElement).outerWidth()+10,$(t.settings.domElement).outerHeight()+10):e.fillRect($(t.settings.domElement).offset().left-5,$(t.settings.domElement).offset().top-5,$(t.settings.domElement).outerWidth()+10,$(t.settings.domElement).outerHeight()+10),e.globalCompositeOperation="source-out"),e.fillStyle=t.settings.overlayColor,e.fillRect(0,0,$("#wutb_overlay2").zWidth(),$("#wutb_overlay2").zHeight()))}function updateOverlayElement(){currentStep&&"showElement"==currentStep.settings.type&&0<$(currentStep.settings.domElement).length&&$("#wutb_OverlayElement").css({width:$(currentStep.settings.domElement).outerWidth(),height:$(currentStep.settings.domElement).outerHeight(),left:$(currentStep.settings.domElement).offset().left,top:$(currentStep.settings.domElement).offset().top})}function updateOverlay(){var t;0<$("#wutb_overlay").length&&($("#wutb_overlay").attr({width:$(document).outerWidth(),height:$(document).outerHeight()}).css({width:$(document).outerWidth(),height:$(document).outerHeight()}),(t=$("#wutb_overlay").get(0).getContext("2d")).globalAlpha=currentStep.settings.overlayOpacity,"showElement"==currentStep.settings.type&&0<$(currentStep.settings.domElement).length&&(t.fillStyle="#FFFFFF",t.globalCompositeOperation="source-over",isAnyParentFixed($(currentStep.settings.domElement))||"fixed"==$(currentStep.settings.domElement).css("position")?t.fillRect($(currentStep.settings.domElement).offset().left-5,$(currentStep.settings.domElement).offset().top-5-$(currentStep.settings.domElement).scrollTop(),$(currentStep.settings.domElement).outerWidth()+10,$(currentStep.settings.domElement).outerHeight()+10):t.fillRect($(currentStep.settings.domElement).offset().left-5,$(currentStep.settings.domElement).offset().top-5,$(currentStep.settings.domElement).outerWidth()+10,$(currentStep.settings.domElement).outerHeight()+10),t.globalCompositeOperation="source-out"),t.fillStyle=currentStep.settings.overlayColor,t.fillRect(0,0,$("#wutb_overlay").zWidth(),$("#wutb_overlay").zHeight()))}function isAnyParentFixed(t,e){e=e||!1,0<t.closest(".x-sidebar").length&&(e=!0);try{0<t.parent().length&&"fixed"==t.parent().css("position")&&(e=!0)}catch(t){}return!e&&0<t.parent().length&&(e=isAnyParentFixed(t.parent(),e)),e}function zeroIfNan(t){return isNaN(t)?0:t}function updateArrow(){var t,e;currentStep&&void 0!==currentStep.settings&&"showElement"==currentStep.settings.type&&0<$(currentStep.settings.domElement).length&&1==$("#wutb_arrow").length&&(t=$(currentStep.settings.domElement).offset().left+$(currentStep.settings.domElement).outerWidth()/2-46,e=$(currentStep.settings.domElement).offset().top-($("#wutb_arrow").zHeight()+8),"down"==currentStep.settings.position?e=$(currentStep.settings.domElement).offset().top+$(currentStep.settings.domElement).zHeight()+8:"left"==currentStep.settings.position?(t=$(currentStep.settings.domElement).offset().left-($("#wutb_arrow").zWidth()+8),e=$(currentStep.settings.domElement).offset().top+($(currentStep.settings.domElement).zHeight()/2-$("#wutb_arrow").zHeight()/2),e-=14):"right"==currentStep.settings.position&&(t=$(currentStep.settings.domElement).offset().left+$(currentStep.settings.domElement).outerWidth()+8,e=$(currentStep.settings.domElement).offset().top+($(currentStep.settings.domElement).zHeight()/2-$("#wutb_arrow").zHeight()/2),e-=14),"top"!=currentStep.settings.position&&(e+=zeroIfNan($("#wpadminbar").zHeight())),$("#wutb_arrow").css({top:e,left:t,marginLeft:currentStep.settings.offsetX,marginTop:currentStep.settings.offsetY}))}function updateElementText(){var t,e;currentStep&&void 0!==currentStep.settings&&"showElement"==currentStep.settings.type&&0<$(currentStep.settings.domElement).length&&1==$("#wutb_elementText").length&&(t=$(currentStep.settings.domElement).offset().left,e=$("#wutb_arrow").position().top-$("#wutb_elementText").zHeight(),"right"==currentStep.settings.position?(t=$("#wutb_arrow").position().left+$("#wutb_arrow").zWidth(),e=$("#wutb_arrow").position().top+$("#wutb_arrow").zHeight()/2-$("#wutb_elementText").zHeight()/2,$("#wutb_elementText").css({top:e,left:t})):"left"==currentStep.settings.position?(t=$("#wutb_arrow").position().left-$("#wutb_elementText").zWidth(),e=$("#wutb_arrow").position().top+$("#wutb_arrow").zHeight()/2-$("#wutb_elementText").zHeight()/2,$("#wutb_elementText").css({top:e,left:t})):"top"==currentStep.settings.position?(t=$(currentStep.settings.domElement).offset().left+$(currentStep.settings.domElement).outerWidth()/2-$("#wutb_elementText").zWidth()/2,e=$("#wutb_arrow").position().top-($("#wutb_elementText").zHeight()+14),$(window).zWidth()<=480&&(t=$(window).zWidth()/2-$("#wutb_elementText").zWidth()/2),$("#wutb_elementText").css({top:e,left:t})):"down"==currentStep.settings.position&&(t=$(currentStep.settings.domElement).offset().left+$(currentStep.settings.domElement).outerWidth()/2-$("#wutb_elementText").zWidth()/2,e=$(window).zHeight()-($("#wutb_arrow").position().top+$("#wutb_arrow").zWidth()-24),$(window).zWidth()<=480&&(t=$(window).zWidth()/2-$("#wutb_elementText").zWidth()/2),e+=$("#wpadminbar").zHeight(),$("#wutb_elementText").css({top:$("#wutb_arrow").position().top+$("#wutb_arrow").zHeight()+14,left:t})))}function updateTooltip(){var t,e;currentStep&&void 0!==currentStep.settings&&"showElement"==currentStep.settings.type&&0<$(currentStep.settings.domElement).length&&1==$("#wutb_tooltip").length&&(t=$(currentStep.settings.domElement).offset().left+$(currentStep.settings.domElement).zWidth()/2-$("#wutb_tooltip").zWidth()/2,e=$(currentStep.settings.domElement).offset().top+$(currentStep.settings.domElement).zHeight()+24,"top"==currentStep.settings.position?(e=$(currentStep.settings.domElement).offset().top-($("#wutb_tooltip").outerHeight()+24),$("#wutb_tooltip .wutb_tooltipArrow").css({borderColor:currentStep.settings.backgroundColor+" transparent transparent transparent"})):"left"==currentStep.settings.position?(t=$(currentStep.settings.domElement).offset().left-($("#wutb_tooltip").outerWidth()+24),e=$(currentStep.settings.domElement).offset().top+$(currentStep.settings.domElement).zHeight()/2-$("#wutb_tooltip").outerHeight()/2,e-=14,$("#wutb_tooltip .wutb_tooltipArrow").css({borderColor:"transparent transparent transparent "+currentStep.settings.backgroundColor})):"right"==currentStep.settings.position?(t=$(currentStep.settings.domElement).offset().left+$(currentStep.settings.domElement).outerWidth()+24,e=$(currentStep.settings.domElement).offset().top+$(currentStep.settings.domElement).zHeight()/2-$("#wutb_tooltip").outerHeight()/2,e-=14,$("#wutb_tooltip .wutb_tooltipArrow").css({borderColor:"transparent "+currentStep.settings.backgroundColor+" transparent transparent"})):$("#wutb_tooltip .wutb_tooltipArrow").css({borderColor:"transparent transparent "+currentStep.settings.backgroundColor+" transparent"}),currentStep.settings.position,$("#wutb_tooltip").css({backgroundColor:currentStep.settings.backgroundColor,color:currentStep.settings.textColor,fontSize:currentStep.settings.textSize+"px",top:e,left:t,marginLeft:currentStep.settings.offsetX+"px",marginTop:currentStep.settings.offsetY+"px"}))}function startTour(t){(currentTour=t).clickedButtons=new Array;t=getStartStepByTour(t);t&&(currentTour.tourData.settings.runOnce&&localStorage.setItem("wutb_viewedTour_"+currentTour.id,1),showStep(t))}function callNextStep(){if($(".tooltip").remove(),void 0===currentStep.mode||"preview"!=currentStep.mode){var t=currentStep.tourID,e=findPotentialsSteps(currentStep.id,t);if(0<e.length){for(var n=!1,o=0;o<e.length;o++){var r=getStepByID(e[o],currentTour);if(r){showStep(r),n=!0;break}}n||stopTour()}else stopTour()}}function findPotentialsSteps(r,s){var i,a,u,l=new Array,t=getTourByID(s);return t&&(i=new Array,a=new Array,u=0,jQuery.each(t.tourData.links,function(){var t,e,n,o=this;o.originID!=r||isNaN(parseInt(o.destinationID))||(n=!(e=!1),o.conditions&&"[]"!=o.conditions&&!Array.isArray(o.conditions)?(e=(t=checkConditions(o.conditions,s)).error,n=t.errorOR):a.push(parseInt(o.destinationID)),("OR"==o.operator&&!n||"OR"!=o.operator&&!e)&&(i.push({stepID:parseInt(o.destinationID),nbConditions:o.conditions.length}),o.conditions.length>u&&(u=o.conditions.length),l.push(parseInt(o.destinationID))))}),0==r&&l.push(getStartStepByTour(t).id),0==l.length||0<a.length&&a.length<l.length&&(jQuery.each(a,function(){var e=this;l=jQuery.grep(l,function(t){return t!=e})}),0<u&&jQuery.each(l,function(e){jQuery.each(i,function(t){t.stepID==e&&t.nbConditions<u&&(l=jQuery.grep(l,function(t){return t!=e}))})}))),l}function checkConditions(t,e){var o=!1,r=!0;return jQuery.each(t.conditions,function(){var t,e,n=this;0==n.elementID.indexOf("btn_")?(t=n.elementID.substr(4,n.elementID.length),"isSelected"==n.action?-1==currentTour.clickedButtons.indexOf(t)?o=!0:r=!1:"isNotSelected"==n.action&&(-1==currentTour.clickedButtons.indexOf(t)?o=!1:r=!0)):"currentURL"==n.elementID?"equals"==n.action?document.location.href!=n.value?o=!0:r=!1:"different"==n.action?document.location.href!=n.value?o=!1:r=!0:"contains"==n.action?-1==document.location.href.indexOf(n.value)?o=!0:r=!1:"dontContains"==n.action&&(-1==document.location.href.indexOf(n.value)?o=!1:r=!0):"currentDate"==n.elementID?"equals"==n.action?moment(new Date).equals(moment(n.value))?r=!1:o=!0:"different"==n.action?moment(new Date).equals(moment(n.value))?o=!0:r=!1:"superior"==n.action?moment(n.value).isAfter(moment(new Date))?r=!1:o=!0:"inferior"==n.action?moment(n.value).isBefore(moment(new Date))?r=!1:o=!0:"monthEquals"==n.action?(e=moment(new Date).format("M"),parseInt(e)!=parseInt(n.value)?o=!0:r=!1):"monthDifferent"==n.action?(e=moment(new Date).format("M"),parseInt(e)==parseInt(n.value)?o=!0:r=!1):"monthSuperior"==n.action?(e=moment(new Date).format("M"),parseInt(e)<=parseInt(n.value)?o=!0:r=!1):"monthInferior"==n.action&&(e=moment(new Date).format("M"),parseInt(e)>=parseInt(n.value)?o=!0:r=!1):"wpUser"==n.elementID&&("usernameIs"==n.action?wutb_toursData.username!=n.value?o=!0:r=!1:"lastNameIs"==n.action?wutb_toursData.lastName!=n.value?o=!0:r=!1:"emailIs"==n.action?wutb_toursData.email!=n.value?o=!0:r=!1:"roleIs"==n.action&&(-1==wutb_toursData.roles.indexOf(n.value)?o=!0:r=!1))}),{error:o,errorOR:r}}function buttonClicked(){var t,e=$(this);e.is('[data-action="nextStep"]')?(-1==currentTour.clickedButtons.indexOf(e.attr("data-id"))&&currentTour.clickedButtons.push(e.attr("data-id")),setTimeout(callNextStep,1e3)):e.is('[data-action="stopTour"]')&&(stopTour(),""!=e.attr("data-url")&&2<e.attr("data-url").length&&setTimeout(function(){document.location.href=e.attr("data-url")},1e3)),""!=currentStep.settings.entryAnimation?(t=currentStep.settings.entryAnimation.replace("In","Out"),e.closest(".wutb_dialog").removeClass(currentStep.settings.entryAnimation),e.closest(".wutb_dialog").addClass(t),setTimeout(function(){e.closest(".wutb_dialogContainer").fadeOut()},600)):e.closest(".wutb_dialogContainer").fadeOut()}function stopTour(){$(".tooltip").remove(),currentStep=currentTour=!1,sessionStorage.removeItem("wutb_currentStep"),sessionStorage.removeItem("wutb_previousSteps"),$("#wutb_stepContainer").fadeOut(1e3),setTimeout(function(){$("#wutb_stepContainer").remove()},1200)}function updateStepSetting(){var key=jQuery("body").data("lastSettingKey"),value=jQuery("body").data("lastSettingValue");void 0!==currentStep&&currentStep&&(eval("currentStep.settings."+key+"=value;"),"offsetX"==key||"offsetY"==key?(drawArrow(),updateArrow(),updateTooltip(),updateElementText()):"text"==key?($(".wutb_fullscreenTextContent,#wutb_elementText,.wutb_tooltipContent,.wutb_dialog-body").html(value),updateArrow(),updateTooltip(),updateElementText()):"headerText"==key?$(".wutb_dialog-header,.wutb_fullscreenTitle").html(value):"headerTextColor"==key?$(".wutb_dialog-header,.wutb_fullscreenTitle").css({color:value}):"headerTextSize"==key?$(".wutb_dialog-header,.wutb_fullscreenTitle").css({fontSize:value+"px"}):"backgroundColor"==key?($(".wutb_dialog-body,#wutb_tooltip").css({backgroundColor:value}),"showElement"==currentStep.settings.type&&"tooltip"==currentStep.settings.textStyle&&("down"==currentStep.settings.position?$(".wutb_tooltipArrow").css({borderColor:"transparent transparent "+value}):"top"==currentStep.settings.position?$(".wutb_tooltipArrow").css({borderColor:value+" transparent transparent "}):"left"==currentStep.settings.position?$(".wutb_tooltipArrow").css({borderColor:"transparent transparent transparent "+value}):"right"==currentStep.settings.position&&$(".wutb_tooltipArrow").css({borderColor:"transparent "+value+" transparent transparent"}))):"textColor"==key?($(".wutb_dialog-body,.wutb_tooltipContent,#wutb_elementText,.wutb_fullscreenText").css({color:value}),drawArrow(),updateArrow()):"textSize"==key?($(".wutb_dialog-body,.wutb_tooltipContent,#wutb_elementText,.wutb_fullscreenText ").css({fontSize:value+"px"}),updateTooltip(),updateArrow(),updateElementText()):"animation"==key?0<$("#wutb_arrow").length?$("#wutb_arrow").attr("class","animated "+value):0<$(".wutb_tooltip").length&&$(".wutb_tooltip").attr("class","wutb_tooltip animated "+value):"entryAnimation"==key?0<$(".wutb_fullscreenTextContent").length?$(".wutb_fullscreenTextContent,.wutb_fullscreenTextTitle").attr("class","wutb_fullscreenText animated "+value):0<$("#wutb_arrow").length?$("#wutb_arrow").attr("class","animated "+value):0<$(".wutb_dialog").length&&$(".wutb_dialog").attr("class","wutb_dialog animated "+value):"useOverlay"==key?value?(drawOverlay(),updateOverlay()):$("#wutb_overlay").remove():"overlayColor"==key||"overlayOpacity"==key?updateOverlay():"headerColor"==key?$(".wutb_dialog-header").css({backgroundColor:value}):"footerColor"==key?$(".wutb_dialog-footer").css({backgroundColor:value}):"headerTextColor"==key?$(".wutb_dialog-header").css({color:value}):"position"==key?($("#wutb_arrow,#wutb_tooltip").attr("data-position",value),updateTooltip(),updateArrow(),updateElementText()):"domElement"==key&&(updateTooltip(),updateArrow(),updateElementText()))}function callPreviousStep(){var t,e;$(".tooltip").remove(),null===sessionStorage.getItem("wutb_previousSteps")||0<(t=sessionStorage.getItem("wutb_previousSteps").split(",")).length&&((e=getStepByID(t[t.length-1],currentTour))&&showStep(e),t.pop(),sessionStorage.setItem("wutb_previousSteps",t.join(",")))}$(window).on("load",function(){$("body").addClass("wutb_frontend"),$("body").on("triggerUpdateStepSetting",updateStepSetting),$("body").on("wutb_triggerAction",executePreviewAction),$("body").on("wutb_startTour",function(){var t=getTourByID($("body").attr("data-starttourid"));t&&startTour(t)}),jQuery(window).resize(onResize),0<wutb_toursData.previewTour&&sessionStorage.removeItem("wutb_selection"),(!isIframe()&&null===sessionStorage.getItem("wutb_selection")||parseInt(sessionStorage.getItem("wutb_selection"))<1)&&(initTours(),$(".start-tour").on("click",function(){if(!currentTour)for(var t=$(this).attr("class").split(" "),e=0;e<t.length;e++){var n=t[e];0==n.indexOf("tour-")&&(n.substr(5,n.length),(n=getTourByID($(this).attr("data-tourid")))&&startTour(n))}})),isIframe()&&$("body").addClass("wutb_framed"),$("*").on("click",function(t){if(selectionInProgress){t.preventDefault();var e,n=this;return jQuery(n).is("option")||(e=!1,(0==jQuery(n).children().length||jQuery(n).is(".wp-menu-name")||jQuery(n).is("img")||jQuery(n).is("a")||jQuery(n).is("button")||jQuery(n).is("select")||jQuery(n).is("iframe")||jQuery(n).is(".mce-tinymce"))&&(e=jQuery(n).is("a")&&0<jQuery(n).find("img").length?jQuery(n).find("img"):jQuery(n)),e&&onSelectionElementClick(e)),!1}if(!currentTour&&!currentStep)for(var o=0;o<wutb_toursData.tours.length;o++){var r=wutb_toursData.tours[o];if("elementClick"==r.tourData.settings.startMethod)if(""!=r.tourData.settings.tourDomElement&&0<$(r.tourData.settings.tourDomElement).length&&$(r.tourData.settings.tourDomElement).is($(this)))if($(r.tourData.settings.tourDomElement).attr("data-tourid",r.id),!r.tourData.settings.runOnce||null===localStorage.getItem("wutb_viewedTour_"+r.id))if(t.preventDefault(),!currentTour)if(r=getTourByID($(this).attr("data-tourid")))return startTour(r),!1}}),$('[class^="open-tour-"],[class*=" open-tour-"]').on("click",function(){if(!currentTour&&!currentStep)for(var t=$(this).attr("class").split(" "),e=0;e<t.length;e++){var n,o=t[e];0!=o.indexOf("open-tour-")||(o=getTourByID(n=o.substr(10,o.length)))&&(localStorage.removeItem("wutb_viewedTour_"+n),startTour(o))}})})}(jQuery);